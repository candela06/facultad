1)---------------------------------------------
SELECT i.DNI, i.nombre, i.apellido, i.email
FROM Integrante i
WHERE i.ciudad = 'La Plata'
AND EXISTS (
	SELECT 1
	FROM Equipo e 
	JOIN Inscripcion ins ON ins.codigoE = e.codigoE
	JOIN TorneoPesca tp ON tp.codTorneo = ins.codTorneo
	WHERE tp.fecha BETWEEN '2023-01-01' AND '2023-12-31'
	AND i.codigoE = e.codigoE
)

2)---------------------------------------------
-- opción 1
SELECT e.nombreE, e.descripcionE
FROM Equipo e
WHERE EXISTS(
	SELECT 1
	FROM TorneoPesca tp
	JOIN Inscripcion ins ON ins.codTorneo = tp.codTorneo
	WHERE tp.fecha BETWEEN '2020-01-01' AND '2020-12-31'
	AND ins.codigoE = e.codigoE
)
AND NOT EXISTS (
	SELECT 1
	FROM TorneoPesca tp
	JOIN Inscripcion ins ON ins.codTorneo = tp.codTorneo
	WHERE (tp.fecha < '2020-01-01' OR tp.fecha > '2020-12-31')
	AND ins.codigoE = e.codigoE
)

-- opción 2

SELECT e.nombreE, e.descripcionE
FROM Equipo e
JOIN Inscripcion ins ON ins.codigoE = e.codigoE
JOIN TorneoPesca tp ON tp.codTorneo = ins.codTorneo
GROUP BY e.codigoE, e.nombreE, e.descripcionE
HAVING MIN(tp.fecha) >= '2020-01-01'
   AND MAX(tp.fecha) <= '2020-12-31';

3)---------------------------------------------
SELECT i.DNI, i.nombre, i.apellido, i.email, i.ciudad
FROM Integrante i
WHERE EXISTS (
	SELECT 1
	FROM TorneoPesca tp
	JOIN Laguna l ON l.nroLaguna = tp.nroLaguna
	JOIN Inscripcion ins ON ins.codTorneo = tp.codTorneo
	WHERE l.nombreL = 'La Salada, Coronel Granada'
	AND ins.codigoE = i.codigoE
	AND ins.asistio = 1
)
AND NOT EXISTS (
	SELECT 1
	FROM TorneoPesca tp2
	JOIN Inscripcion ins2 ON ins2.codTorneo = tp2.codTorneo
	WHERE (tp2.fecha BETWEEN '2023-01-01' AND '2023-12-31')
	AND ins2.codigoE = i.codigoE
)

4)---------------------------------------------
SELECT e.nombreE, e.descripcionE
FROM Equipo e
JOIN Integrante i ON i.codigoE = e.codigoE
GROUP BY e.codigoE, e.nombreE, e.descripcionE
HAVING count(*) >= 5 

5)---------------------------------------------
-- SUPONIENDO QUE TODAS LAS LAGUNAS TUVIERON ALMENOS 1 TORNEO

SELECT e.nombreE, e.descripcionE
FROM Equipo e
WHERE NOT EXISTS (
	SELECT 1
	FROM Laguna l
	WHERE NOT EXISTS (
		SELECT 1
		FROM TorneoPesca tp
		JOIN Inscripcion i ON tp.codTorneo = i.codTorneo
		WHERE tp.nroLaguna = l.nroLaguna
		AND i.codigoE = e.codigoE
	)
)


-- SUPONIENDO QUE HAY LAGUNAS SIN TORNEO
-- no tiene sentido la consulta pq no va a devolver ningun equipo xd
SELECT e.nombreE, e.descripcionE
FROM Equipo e
WHERE NOT EXISTS (
	SELECT 1
	FROM Laguna l
	WHERE EXIST(
		SELECT 1
		FROM torneoPesca t
		WHERE t.nroLaguna = l.nroLaguna
	)
	WHERE NOT EXISTS (
		SELECT 1
		FROM TorneoPesca tp
		JOIN Inscripcion i ON tp.codTorneo = i.codTorneo
		WHERE tp.nroLaguna = l.nroLaguna
		AND i.codigoE = e.codigoE
	)
)


-- otra opción con las dos versiones
SELECT e.nombreE, e.descripcionE
FROM Equipo e
JOIN Inscripcion i ON i.codigoE = e.codigoE
JOIN TorneoPesca tp ON tp.codTorneo = i.codTorneo
GROUP BY e.codigoE, e.nombreE, e.descripcionE
HAVING COUNT(DISTINCT tp.nroLaguna) = (SELECT COUNT(*) FROM Laguna)

--

SELECT e.nombreE, e.descripcionE
FROM Equipo e
JOIN Inscripcion i ON i.codigoE = e.codigoE
JOIN TorneoPesca tp ON tp.codTorneo = i.codTorneo
GROUP BY e.codigoE, e.nombreE, e.descripcionE
HAVING COUNT(DISTINCT tp.nroLaguna) = (SELECT COUNT(t.nroLaguna) FROM TorneoPesca t)



6)---------------------------------------------
DELETE FROM Inscripcion WHERE codigoE = 10000;

DELETE FROM Integrante WHERE codigoE = 10000;

DELETE FROM Equipo WHERE codigoE = 10000;

7)---------------------------------------------
SELECT l.nombreL, l.ubicacion, l.extension, l.descripcion
FROM Laguna l
WHERE NOT EXISTS (
	SELECT 1
	FROM TorneoPesca tp
	WHERE tp.nroLaguna = l.nroLaguna
)

8)---------------------------------------------
SELECT e.nombreE, e.descripcionE
FROM Equipo e
WHERE EXISTS (
	SELECT 1
	FROM TorneoPesca tp
	JOIN Inscripcion i ON i.codTorneo = tp.codTorneo
	WHERE tp.fecha BETWEEN '2024-01-01' AND '2024-12-31'
	AND i.codigoE = e.codigoE
)
AND NOT EXISTS (
	SELECT 1
	FROM TorneoPesca tp
	JOIN Inscripcion i ON i.codTorneo = tp.codTorneo
	WHERE tp.fecha BETWEEN '2023-01-01' AND '2023-12-31'
	AND i.codigoE = e.codigoE
)

9)---------------------------------------------
SELECT DISTINCT i.DNI, i.nombre, i.apellido, i.ciudad, i.email 
FROM Integrante i
JOIN Inscripcion ins ON ins.codigoE = i.codigoE
JOIN TorneoPesca tp ON tp.codTorneo = ins.codTorneo
JOIN Laguna l ON l.nroLaguna = tp.nroLaguna
WHERE l.nombreL = 'Laguna de Chascomús'
AND ins.gano = TRUE
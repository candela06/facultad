3)
SELECT *
FROM Producto p
WHERE idProducto IN (
	-- productos comprados por el Cliente con dni 45789456
	SELECT d.idProducto
	FROM Cliente c
	JOIN Factura f ON c.idCliente = f.idCliente
	JOIN Detalle d ON f.nroTicket = d.nroTicket
	WHERE c.DNI = '45789456' 
	)
AND idProducto NOT IN (
	-- productos comprados por el cliente de apellido garcia
	SELECT d.idProducto
	FROM Cliente c
	JOIN Factura f ON c.idCliente = f.idCliente
	JOIN Detalle d ON f.nroTicket = d.nroTicket
	WHERE c.apellido = 'Garcia'
)
-- ORDER BY idProducto


4) Listar nombre, descripción, precio y stock de productos no vendidos a clientes que tengan
teléfono con característica 221 (la característica está al comienzo del teléfono). Ordenar por
nombre

SELECT *
FROM Producto p
WHERE idProducto NOT IN (
	SELECT idProducto
	FROM Cliente c
	JOIN Factura f ON c.idCliente = f.idCliente
	JOIN Detalle d ON f.nroTicket = d.nroTicket
	WHERE c.telefono like '221%' 
)
ORDER BY nombreP

5)
SELECT nombreP, descripcion, precio, count(d.idProducto) AS veces_vendido
FROM Producto p
LEFT JOIN Detalle d ON p.idProducto = d.idProducto
GROUP BY p.idProducto, p.nombreP, p.descripcion, p.precioA

6)
SELECT *
FROM Cliente c
WHERE c.idCliente IN (
	SELECT idCliente
	FROM Factura f
	JOIN Detalle d ON f.nroTicket = d.nroTicket
	JOIN Producto p ON d.idProducto = p.idProducto
	WHERE p.nombreP = 'prod2'
	)
AND c.idCliente IN(
	SELECT idCliente
	FROM Factura f
	JOIN Detalle d ON f.nroTicket = d.nroTicket
	JOIN Producto p ON d.idProducto = p.idProducto
	WHERE p.nombreP = 'prod1'
)
AND c.idCliente NOT IN (
	SELECT idCliente
	FROM Factura f
	JOIN Detalle d ON f.nroTicket = d.nroTicket
	JOIN Producto p ON d.idProducto = p.idProducto
	WHERE p.nombreP = 'prod3'
)

7)
SELECT f.nroTicket, f.total, f.fecha, f.hora, c.DNI
FROM Factura f
JOIN Cliente c ON f.idCliente = c.idCliente
WHERE f.nroTicket IN (
	SELECT f.nroTicket
	FROM Cliente c
	JOIN Factura f ON c.idCliente = f.idCliente
	JOIN Detalle d ON f.nroTicket = d.nroTicket
	JOIN Producto p ON d.idProducto = p.idProducto
	WHERE p.nombreP = 'prod38'
)
OR f.nroTicket IN (
	SELECT f.nroTicket
	FROM Cliente c
	JOIN Factura f ON c.idCliente = f.idCliente
	WHERE f.fecha BETWEEN '2023-01-01' AND '2023-12-31'
)

8)
INSERT INTO Cliente (idCliente,nombre,apellido,DNI,telefono,direccion)
VALUES (500002,'Jorge Luis','Castor','40578999','221-4400789','11 entre 500 y 501 nro:2587')
-- WHERE NOT EXISTS (SELECT 1 FROM Cliente WHERE idCliente=500002)

9)
SELECT f.nroTicket, f.total, f.fecha, f.hora, c.nombre
FROM Cliente c
JOIN Factura f ON c.idCliente = f.idCliente
WHERE (c.nombre = 'Pedro' AND c.apellido = 'Perez')
AND NOT EXISTS (
	SELECT 1
	FROM Detalle d
	JOIN Producto p ON d.idProducto = p.idProducto
	WHERE d.nroTicket = f.nroTicket
	AND p.nombreP = 'Z'
)

10)
SELECT c.DNI, c.apellido, c.nombre, f.nroTicket
FROM Cliente c
JOIN Factura f ON c.idCliente = f.idCliente
GROUP BY c.DNI, c.apellido, c.nombre
HAVING SUM(f.total) > 100000

